var OCRUISE=function(d){d.currentDate=function(){var a=new Date;return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()};d.init=function(){$(document).ready(function(){window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;window.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction;window.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;if(!window.openDatabase&&!window.indexedDB)alert("Local Databases are not supported by your browser.");
else{navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(){},function(){},{timeout:5E4,maximumAge:0,enableHighAccuracy:!0});new FastClick(document.body);d.defaultValues=new d.config;localStorage.defaults?d.defaultValues.load():d.defaultValues.save();var a=d.defaultValues,b=function(){d.activeList=new d.cruiseList(a.pages.cruisePage);d.activeList.getCruises();ko.applyBindings(d.activeList,$("#cruiseListPage")[0]);ko.applyBindings(d.activeList,$("#cruisePage")[0]);ko.applyBindings(d.activeList,
$("#emailPage")[0]);ko.applyBindings(d.activeList,$("#plotPage")[0]);ko.applyBindings(d.defaultValues,$("#configPage")[0])};d.DB=window.openDatabase?new d.webSQL(d.webSQLConfig(),b):new d.indexedDB(d.indexedDBConfig(),b);$(".OCLoading").hide();$.mobile.initializePage();$.mobile.changePage(a.pages.cruiseListPage);$("#cruisePage").bind("pagebeforeshow",function(){$("#selectPlotPopup ul").listview().listview("refresh");$("#cruisePage").trigger("create")});$("#selectPlotPopup").on("click","li a",function(){d.activeList.selectedCruise().editPlot($(this).data("plotnum"))});
$("#plotPage").bind("pagebeforeshow",function(){$("#plotPage").trigger("create")})}})};d.webSQLConfig=function(){var a=d.defaultValues;return{name:"CRUISEDB",version:"1.0",descript:"CRUISE DB",maxsize:2E5,tables:[{tableName:"cruise",fields:[{name:"cruiseid",type:"INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"cname",type:"TEXT NOT NULL"},{name:"cpeople",type:"TEXT NOT NULL"},{name:"cdate",type:"TEXT"},{name:"cbaf",type:"TEXT"}]},{tableName:"plots",index:{name:"cruiseid_idx",fields:"cruiseid"},
fields:[{name:"id",type:"INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},{name:"cruiseid",type:"INTEGER NOT NULL"},{name:"plotnum",type:"INTEGER NOT NULL"},{name:"plotid",type:"TEXT NOT NULL"},{name:"comments",type:"TEXT"},{name:"covertype",type:"TEXT"},{name:"accuracy",type:"INTEGER"},{name:"latitude",type:"REAL"},{name:"longitude",type:"REAL"},{name:"deleted",type:"INTEGER"}]},{tableName:"trees",index:{name:"cruiseid_plotnum_idx",fields:"cruiseid, plotnum"},fields:[{name:"treeid",type:"INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT"},
{name:"cruiseid",type:"INTEGER NOT NULL"},{name:"plotnum",type:"INTEGER NOT NULL"},{name:"plotid",type:"TEXT NOT NULL"},{name:"treenum",type:"INTEGER"},{name:a.field1.dbName,type:"TEXT NOT NULL"},{name:a.field2.dbName,type:"INTEGER NOT NULL"},{name:a.field3.dbName,type:"INTEGER"},{name:a.field4.dbName,type:"INTEGER"},{name:"deleted",type:"INTEGER"}]}]}};d.indexedDBConfig=function(){return{name:"CRUISEDB",version:2,stores:[{storeName:"cruise",keyPath:"cruiseid",autoIncrement:!0,indexes:[{name:"cruiseid",
fields:"cruiseid",unique:!0}]},{storeName:"plots",keyPath:["cruiseid","plotnum"],autoIncrement:!1,indexes:[{name:"cruiseid",fields:"cruiseid",unique:!1},{name:"cruiseidplotnum",fields:["cruiseid","plotnum"],unique:!0}]},{storeName:"trees",keyPath:["cruiseid","plotnum","treenum"],autoIncrement:!1,indexes:[{name:"cruiseid",fields:"cruiseid",unique:!1},{name:"cruiseidplotnum",fields:["cruiseid","plotnum"],unique:!1}]}]}};return d}(OCRUISE||{});OCRUISE=function(d){d.cruiseList=function(a){var b=this;this.editCruisePage=a;this.cruises=ko.observableArray([]);this.selectedCruise=ko.observable(new d.cruise(0,"","","",""));this.deleteCruise=function(a){if(confirm("Delete cruise?")){var e={cruiseid:a.cruiseID};d.DB.deleteRows([["cruise",e],["plots",e],["trees",e]],function(){b.logMessage("Cruise deleted.")});b.cruises.remove(a)}};this.editCruise=function(a){b.selectedCruise(a);$.mobile.changePage(b.editCruisePage)}};d.cruiseList.prototype={getCruises:function(){var a=
this;d.DB.select("cruise","*","",function(b,c){a.updateListPageDOM(b,c)})},newCruise:function(a){var b=d.defaultValues.cruiseParms;d.DB.insert([["cruise",["cname","cpeople","cdate","cbaf"],[b.jobName,b.cruisers,b.date,b.BAF]]],function(c,e){var g=new d.cruise(e.insertId,b.jobName,b.date,b.cruisers,b.BAF);a.cruises.push(g);a.editCruise(g)},function(){a.logMessage("Cruise created.")})},deleteDatabase:function(){d.DB.deleteDatabase()},updateListPageDOM:function(a,b){for(var c=0;c<b.rows.length;c++){var e=
b.rows.item(c);this.cruises.push(new d.cruise(e.cruiseid,e.cname,e.cdate,e.cpeople,e.cbaf))}},logMessage:function(a){console.log(a)}};return d}(OCRUISE||{});OCRUISE=function(d){d.cruise=function(a,b,c,e,g){var f=d.defaultValues;this.self=this;this.cruiseName=ko.observable(b);this.people=ko.observable(e);this.BAF=ko.observable(g);this.date=ko.observable(c);this.selectedPlot=ko.observable();this.plots=ko.observableArray([]);this.cruiseID=a;this.defaultSpecies=f.defaultSpecies;this.loadPlots();this.field1Values=ko.observableArray(f.speciesKey.toArray())};d.cruise.prototype={newPlot:function(a){$.mobile.loading("show",{text:"Loading",textVisible:!0,theme:"e",
html:""});var b=a.selectedCruise();d.DB.select("trees","plotnum","",function(a,e){for(var g=1,f=0;f<e.rows.length;f++)g=e.rows.item(f).MAXPLOT+1,b.selectedPlot(new d.plot("new",b.cruiseID,g,b.defaultSpecies())),$.mobile.changePage("#plotPage",{role:"dialog"})},"MAXPLOT",{cruiseid:b.cruiseID})},updateCruise:function(a){var b={cname:a.cruiseName(),cpeople:a.people(),cdate:a.date(),cbaf:a.BAF()};d.DB.update("cruise",b,{cruiseid:a.cruiseID})},loadPlots:function(){var a=this;d.DB.select("plots","*","plotnum",
function(b,c){for(var e=0;e<c.rows.length;e++){var g=c.rows.item(e);a.plots.push({plotNum:g.plotnum,plotID:g.plotid})}},"",{cruiseid:a.cruiseID})},editPlot:function(a){$.mobile.loading("show",{text:"Loading",textVisible:!0,theme:"e",html:""});this.selectedPlot(new d.plot("edit",this.cruiseID,a,this.defaultSpecies()))},exporttoCSV:function(a){var b={plots:"",trees:"",cruise:""};$.mobile.loading("show",{text:"Connecting to server....",textVisible:!0,theme:"b",html:""});var c=a.selectedCruise(),e={cruiseid:c.cruiseID};
a=function(a,f){b.trees=c.buildCSV(a,f);d.DB.select("plots","*","plotnum",g,"",e)};var g=function(a,g){b.plots=c.buildCSV(a,g);d.DB.select("cruise","*","",f,"",e)},f=function(a,e){b.cruise=c.buildCSV(a,e);c.sendEmail(b)},h=$("#emailTo").val();/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(h)?d.DB.select("trees","*","plotnum",a,"",e):(alert("Invalid email address"),$.mobile.loading("hide"))},buildCSV:function(a,b){var c="",e;if(0<b.rows.length){e=b.rows.item(0);for(var g in e)c+=g+",";c=c.substring(0,
c.length-1);c+="\r\n"}for(g=0;g<b.rows.length;g++){e=b.rows.item(g);for(var f in e)c+=e[f]+",";c=c.substring(0,c.length-1);c+="\r\n"}return c},sendEmail:function(a){$.ajax({type:"POST",url:"gmail.php",data:{data:"sep=,\r\n"+a.cruise+a.plots+a.trees,emailTo:$("#emailTo").val(),emailPW:$("#emailPW").val(),cruiseName:this.cruiseName},success:function(a){$.mobile.loading("hide");$("#emailSentPopup p").html("Results: "+a);$("#emailSentPopup").popup("open")},error:function(a,c){$.mobile.loading("hide");
$("#emailSentPopup p").html("Error: "+c+" - Make sure you have a network connection.");$("#emailSentPopup").popup("open")},dataType:"text"})}};return d}(OCRUISE||{});OCRUISE=function(d){d.plot=function(a,b,c,e){var g=d.defaultValues;this.field1Name=g.field1.name();this.field2Name=g.field2.name();this.field3Name=g.field3.name();this.field4Name=g.field4.name();this.plotnum=c;this.trees=ko.observableArray([]);this.plotID=ko.observable(c.toString());this.cruiseid=b;this.defaultSpecies=e;this.lastEditedTree=-1;this.showSaveButton=ko.observable(!0);this.showUpdateButton=ko.observable(!1);this.showSpeechButton=ko.observable(!1);this.position={coords:{accuracy:null,latitude:null,
longitude:null}};if("webkitSpeechRecognition"in window){var f=this;this.recognition=new webkitSpeechRecognition;this.recognition.onresult=function(a){f.speechInputResult(a)};this.showSpeechButton(!0)}"new"==a?this.initPlot():this.loadPlot()};d.plot.prototype={initPlot:function(){for(var a=0;10>a;a++)this.trees.push(new d.tree(this.defaultSpecies,null,0,null));this.updatePosition();this.showSaveButton(!0);this.showUpdateButton(!1)},addTree:function(){this.trees.push(new d.tree(this.defaultSpecies,
null,0,null));$("#plotDetail").trigger("create")},loadPlot:function(){var a=this,b=d.defaultValues;this.showSaveButton(!1);this.showUpdateButton(!0);var c={cruiseid:this.cruiseid,plotnum:this.plotnum},e=function(c,e){for(var h=0;h<e.rows.length;h++){var j=e.rows.item(h);a.trees.push(new d.tree(j[b.field1.dbName],j[b.field2.dbName],j[b.field3.dbName],j[b.field4.dbName]));a.lastEditedTree++}j&&a.plotID(j.plotid);$.mobile.changePage("#plotPage",{role:"dialog"})};d.DB.select("plots","*","",function(b,
f){a.position={coords:{accuracy:null,latitude:null,longitude:null}};if(0<f.rows.length){var h=f.rows.item(0);a.plotID(h.plotid);a.position={coords:{accuracy:h.accuracy,latitude:h.latitude,longitude:h.longitude}}}d.DB.select("trees","*","",e,"",c)},"",c)},updatePosition:function(){var a=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(b){a.position=b},function(){},{timeout:5E4,maximumAge:0,enableHighAccuracy:!0})},speechInputStart:function(){$.mobile.loading("show",{text:"Begin Speaking Now",
textVisible:!0,theme:"b",html:""});this.recognition.start()},speechInputResult:function(a){var b=d.defaultValues,c,e,g=this.trees();$.mobile.loading("hide");a=a.results[0][0].transcript.replace("Dash","-");a=a.replace("dash","-");a=a.split("-");g[this.lastEditedTree+1]&&(this.lastEditedTree++,a[0]&&(c=a[0].replace(/[0-9]+/g,""),c=c.replace(/\s+/g,""),e=a[0].replace(/[a-zA-Z]+/g,""),e=e.replace(/\s+/g,""),(c=b.speciesKey.getKey(c.toLowerCase()))&&g[this.lastEditedTree].field1(c),g[this.lastEditedTree].field2(e)),
a[1]&&(b=a[1].replace(/\s+/g,""),g[this.lastEditedTree].field3(b)),a[2]&&(b=a[2].replace(/\s+/g,""),g[this.lastEditedTree].field4(b)))},insertPlot:function(a){var b=d.defaultValues,c=this,e=this.trees(),g=[],f=this.position,h="cruiseid plotid plotnum comments covertype accuracy latitude longitude deleted".split(" ");g.push(["plots",h,[this.cruiseid,this.plotID(),this.plotnum,"","",f.coords.accuracy,f.coords.latitude,f.coords.longitude,0]]);var f="trees",h=["cruiseid","plotid","plotnum","treenum",
b.field1.dbName,b.field2.dbName,b.field3.dbName,b.field4.dbName,"deleted"],j;for(j in e)0<e[j].field2()&&g.push([f,h,[this.cruiseid,this.plotID(),this.plotnum,j,e[j].field1(),e[j].field2(),e[j].field3(),e[j].field4(),0]]);d.DB.insert(g,function(){return!0},function(){a&&(a.plots.push({plotNum:c.plotnum,plotID:c.plotID()}),c.logMessage("Plot added."));$.mobile.changePage("#cruisePage")})},updatePlot:function(a){var b=this,c={cruiseid:this.cruiseid,plotnum:this.plotnum};d.DB.deleteRows([["plots",c],
["trees",c]],function(){a.plots.remove(function(a){return a.plotNum==b.plotnum})});this.insertPlot(a)},logMessage:function(a){console.log(a)}};return d}(OCRUISE||{});OCRUISE=function(d){d.tree=function(a,b,c,e){var g=d.defaultValues.speciesKey.toArray();-1==g.indexOf(a)&&g.push(a);this.field1=ko.observable(a);this.field2=ko.observable(b);this.field3=ko.observable(c);this.field4=ko.observable(e);this.field1Values=ko.observableArray(g)};d.tree.prototype={validateTree:function(a,b){var c=d.defaultValues,e=b.target;"field2"==e.id&&(e.value<c.field2.min||e.value>c.field2.max)?$(e).parent().css("background-color","#FF0000"):"field3"==e.id&&0<e.value&&a.field2()<c.field3.field2Min?
$(e).parent().css("background-color","#FF0000"):"field3"==e.id&&(e.value<c.field3.min||e.value>c.field3.max)?$(e).parent().css("background-color","#FF0000"):"field4"==e.id&&(e.value<c.field4.min||e.value>c.field4.max)?$(e).parent().css("background-color","#FF0000"):$(e).parent().css("background-color","#088A08")}};return d}(OCRUISE||{});OCRUISE=function(d){d.webSQL=function(a,b){this.name=a.name;this.version=a.version;this.tableNames=a.tables;this.initDatabase(a,b)};d.webSQL.prototype={insert:function(a,b,c){for(var e=this,g=[],f=0;f<a.length;f++){g[f]="INSERT INTO "+a[f][0]+" (";for(var d="",j="",k=0;k<a[f][1].length;k++)d=d+a[f][1][k]+", ",j+="?, ";g[f]=g[f]+d.substring(0,d.length-2)+") VALUES("+j.substring(0,j.length-2)+")"}this.DB.transaction(function(c){for(f=0;f<g.length;f++)c.executeSql(g[f],a[f][2],b,function(a,c){e.errorHandler(a,
c)})},function(a,c){e.errorHandler(a,c)},c)},select:function(a,b,c,e,g,f){var d=this,j=b;g&&(j="MAX("+b+") AS "+g);var k="SELECT "+j+" FROM "+a;if(f){var k=k+" WHERE ",l;for(l in f)k+=l+"="+f[l]+" AND ";k=k.substring(0,k.length-5)}""!=c&&(k+=" ORDER BY "+c);k+=";";this.DB.transaction(function(a){a.executeSql(k,[],e,function(a,c){d.errorHandler(a,c)})})},update:function(a,b,c){var e=this,g=[],f="UPDATE "+a+" SET",d;for(d in b)f+=" "+d+"=?,",g.push(b[d]);f=f.substring(0,f.length-1);if(c){f+=" WHERE ";
for(d in c)f+=d+"="+c[d]+" AND ";f=f.substring(0,f.length-5)}f+=";";this.DB.transaction(function(a){a.executeSql(f,g,e.nullDataHandler(),function(a,c){e.errorHandler(a,c)})})},deleteRows:function(a,b){for(var c=this,e=[],d=null,f=0;f<a.length;f++){e[f]="DELETE FROM "+a[f][0];e[f]+=" WHERE ";var d=a[f][1],h;for(h in d)e[f]+=h+"="+d[h]+" AND ";e[f]=e[f].substring(0,e[f].length-5)+";"}this.DB.transaction(function(a){for(f=0;f<e.length;f++)a.executeSql(e[f],[],b,function(a,b){c.errorHandler(a,b)})})},
initDatabase:function(a,b){this.DB=openDatabase(a.name,a.version,a.descript,a.maxsize);this.createTables(a,b)},createTables:function(a,b){var c=this,e="";this.DB.transaction(function(b){for(var f in a.tables){e="";e+="CREATE TABLE IF NOT EXISTS "+a.tables[f].tableName+"(";for(var d in a.tables[f].fields)e+=a.tables[f].fields[d].name+" "+a.tables[f].fields[d].type+", ";e=e.substring(0,e.length-2)+");";b.executeSql(e,[],function(){c.nullDataHandler()},function(a,b){c.errorHandler(a,b)});a.tables[f].index&&
(e="CREATE INDEX IF NOT EXISTS "+a.tables[f].index.name+" ON "+a.tables[f].tableName+" ("+a.tables[f].index.fields+");",b.executeSql(e,[],function(){c.nullDataHandler()},function(a,b){c.errorHandler(a,b)}))}},function(a,b){c.errorHandler(a,b)},b)},deleteDatabase:function(){var a=this,b=[];if(confirm("All data will be erased, are you sure?")){for(var c=0;c<this.tableNames.length;c++)b[c]="DROP TABLE IF EXISTS "+this.tableNames[c].tableName+";";this.DB.transaction(function(e){for(c=0;c<b.length;c++)e.executeSql(b[c],
[],a.nullDataHandler(),function(b,c){a.errorHandler(b,c)})},function(b,c){a.errorHandler(b,c)},function(){window.location.reload(!1)})}},nullDataHandler:function(){console.log("SQL Query Succeeded!!!")},errorHandler:function(a,b){console.log("Database Error:  "+b.message+" (Code "+b.code+")");alert("Database Error:  "+b.message+" (Code "+b.code+") - make sure private browsing is OFF.");return!1}};d.indexedDB=function(a,b){this.name=a.name;this.version=a.version;this.initDatabase(a,b)};d.indexedDB.prototype=
{insert:function(a,b,c){for(var e=[],d={},f=0;f<a.length;f++)e[f]=a[f][0];var h=this.DB.transaction(e,"readwrite");h.oncomplete=function(){c()};for(f=0;f<a.length;f++){for(var j=h.objectStore(e[f]),k=0;k<a[f][1].length;k++)d[a[f][1][k]]=a[f][2][k];j=j.add(d);d={};j.onerror=function(){alert("IndexedDB Error.")};j.onsuccess=function(a){b(null,{insertId:a.target.result})}}},select:function(a,b,c,e,d,f){c="next";d&&(c="prev");var h={rows:{length:0,contents:[],item:function(a){return this.contents[a]}}};
a=this.DB.transaction(a,"readonly").objectStore(a);var j={indexName:a.indexNames[0],indexRange:null};f&&(j=this.buildKeyRange(f));a.index(j.indexName).openCursor(j.indexRange,c).onsuccess=function(a){if(a=a.target.result)if(h.rows.length++,h.rows.contents.push(a.value),d)h.rows.contents[0][d]=a.value[b],e("",h);else a["continue"]();else d&&(h.rows.contents[0]={},h.rows.contents[0][d]=0,h.rows.length=1),e("",h)}},update:function(a,b,c){for(var e in c)b[e]=c[e];this.DB.transaction(a,"readwrite").objectStore(a).put(b).onerror=
function(){alert("IndexedDB Error - error updating cruise parameters.")}},deleteRows:function(a,b){for(var c=[],e={},d=0;d<a.length;d++)c[d]=a[d][0];var f=this.DB.transaction(c,"readwrite");f.oncomplete=function(){b()};for(d=0;d<a.length;d++){var h=f.objectStore(c[d]),e=this.buildKeyRange(a[d][1]);h.index(e.indexName).openCursor(e.indexRange).onsuccess=function(a){if(a=a.target.result)a["delete"](),a["continue"]()}}},initDatabase:function(a,b){var c=this,e=indexedDB.open(a.name,a.version);e.onerror=
function(){alert("IndexedDB Error - could not open database.")};e.onsuccess=function(a){c.DB=a.target.result;b();c.DB.onerror=function(a){c.errorHandler(a)}};e.onupgradeneeded=function(b){c.createTables(b,a)}},createTables:function(a,b){this.DB=a.target.result;for(var c=0;c<b.stores.length;c++)for(var e=this.DB.createObjectStore(b.stores[c].storeName,{keyPath:b.stores[c].keyPath,autoIncrement:b.stores[c].autoIncrement}),d=0;d<b.stores[c].indexes.length;d++)e.createIndex(b.stores[c].indexes[d].name,
b.stores[c].indexes[d].fields,{unique:b.stores[c].indexes[d].unique})},deleteDatabase:function(){confirm("All data will be erased, are you sure?")&&(window.indexedDB.deleteDatabase(this.name),window.location.reload(!1))},buildKeyRange:function(a){var b=[],c={indexName:"",indexRange:null},d;for(d in a)c.indexName+=d,b.push(parseInt(a[d]));c.indexRange=1==b.length?IDBKeyRange.only(b[0]):IDBKeyRange.only(b);return c},nullDataHandler:function(){console.log("IndexedDB Query Succeeded!!!")},errorHandler:function(a){console.log("IndexedDB Database Error: "+
a.target.errorCode);return!1}};return d}(OCRUISE||{});OCRUISE=function(d){d.config=function(){this.cruiseParms={jobName:"New Cruise",cruisers:"Michigan Tech FERM",date:d.currentDate(),BAF:"10"};this.speciesKey={species:ko.observableArray([{key:"HM",names:["hardmaple","sugarmaple"]},{key:"RM",names:["redmaple","softmaple"]},{key:"AS",names:["aspen"]},{key:"RO",names:["redoak","oak","ok"]},{key:"BF",names:["balsamfir"]},{key:"YB",names:["yellowbirch"]},{key:"PB",names:["paperbirch","whitebirch"]},{key:"BW",names:["basswood"]},{key:"WA",names:["whiteash"]},
{key:"BA",names:["blackash"]},{key:"BC",names:["blackcherry"]},{key:"BP",names:["balsampoplar"]},{key:"WP",names:["whitepine"]},{key:"RP",names:["redpine"]},{key:"JP",names:["jackpine"]},{key:"WS",names:["whitespruce"]},{key:"BS",names:["blackspruce"]},{key:"TM",names:["tamarack"]},{key:"WC",names:["whitecedar","cedar"]},{key:"EH",names:["hemlock"]},{key:"AE",names:["elm"]},{key:"IW",names:["ironwood"]},{key:"MA",names:["mountainash"]},{key:"SNAG",names:["snag"]}])};this.defaultSpecies=ko.observable("HM");
this.field1={name:ko.observable("Species"),dbName:"species"};this.field2={name:ko.observable("DBH"),dbName:"dbh",min:5,max:45,initValue:""};this.field3={name:ko.observable("Saw"),dbName:"sawlogs",min:0,max:10,initValue:0,field2Min:11};this.field4={name:ko.observable("Pulp"),dbName:"pulpsticks",min:0,max:12,initValue:""};this.grade=["W","1","2","3","V"];this.BAF=[10,20,40,80];this.pages={cruiseListPage:"#cruiseListPage",cruisePage:"#cruisePage"};this.speciesKey.deleteSpecies=function(a){this.species.remove(a)};
this.speciesKey.addSpecies=function(){this.species.unshift({key:"new",names:[]});$("#configPage").trigger("create")};this.speciesKey.getKey=function(a){for(var b=0;b<this.species().length;b++)for(var c=0;c<this.species()[b].names.length;c++)if(this.species()[b].names[c]==a)return this.species()[b].key;return null};this.speciesKey.toArray=function(){for(var a=[],b=0;b<this.species().length;b++)a.push(this.species()[b].key);return a};this.save=function(a){a&&(a.max&&(a.max=parseInt(a.max,10)),a.min&&
(a.min=parseInt(a.min,10)));localStorage.defaults=ko.toJSON(this)};this.load=function(){var a=JSON.parse(localStorage.defaults);this.speciesKey.species(a.speciesKey.species);this.cruiseParms.jobName=a.cruiseParms.jobName;this.cruiseParms.cruisers=a.cruiseParms.cruisers;this.cruiseParms.BAF=a.cruiseParms.BAF;this.defaultSpecies(a.defaultSpecies);this.field1.name(a.field1.name);this.field2.name(a.field2.name);this.field3.name(a.field3.name);this.field4.name(a.field4.name);this.field2.min=a.field2.min;
this.field2.max=a.field2.max;this.field3.min=a.field3.min;this.field3.max=a.field3.max;this.field4.min=a.field4.min;this.field4.max=a.field4.max}};return d}(OCRUISE||{});